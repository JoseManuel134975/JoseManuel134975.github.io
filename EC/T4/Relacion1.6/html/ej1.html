<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading List</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <h1>IMG</h1>
        <h1>The Reading List</h1>
    </header>

    <main class="container">
        <section class="container__item main-section">
            <article class="main-section__item form">
                <div class="form__title1">
                    <h3>Book</h3>
                </div>
                <form action="" name="form">
                    <div class="form__title">
                        <label for="Title">Title</label>
                        <br>
                        <input type="text" name="title" id="title">
                    </div>
                    <div class="form__author-genre">
                        <div class="author-genre__item author-genre--author">
                            <label for="Author">Author</label>
                            <br>
                            <input type="text" name="author" id="author">
                        </div>
                        <div class="author-genre__item author-genre--genre">
                            <label for="Genre">Genre</label>
                            <br>
                            <input type="text" name="genre" id="genre">
                        </div>
                    </div>
                    <hr>
                    <input type="submit" value="Add book" name="submit" class="submit">
                </form>
            </article>
            <article class="main-section__item bookList">
                <div class="bookList__title">
                    <h3>My Reading List</h3>
                </div>
                <!-- <div class="bookList__book">
                    <div class="book--title">
                        <h3>Título del libro</h3>
                        <p>autor1</p>
                    </div>
                    <div class="book--date">
                        <p>Read on Friday, November 10, 2023</p>
                    </div>
                </div>
                <div class="bookList__book">
                    <div class="book--title">
                        <h3>Título del libro</h3>
                        <p>autor1</p>
                    </div>
                    <div class="book--date">
                        <p>Read on Friday, November 10, 2023</p>
                    </div>
                </div> -->

                <!-- <p>Books Read: 0 of 6</p> -->
            </article>
        </section>
    </main>

    <script>
        class BookList {
            constructor() {
                this.readBooks = 0
                this.notReadBooks = 0
                this.nextBook = null
                this.currentBook = null
                this.lastBook = null
                this.allBooks = []
            }

            add(book) {
                this.allBooks.push(book)
            }

            finishCurrentBook() {
                this.currentBook.read = true

                this.lastBook = this.currentBook
                this.currentBook = this.nextBook
            }
        }

        class Book {
            constructor(title, genre, author, read, readDate) {
                this.title = title
                this.genre = genre
                this.author = author
                this.read = read
                this.readDate = readDate
            }
        }

        let bookList = new BookList()
        const submit = document.querySelector('.submit')

        submit.addEventListener("click", (event) => {
            event.preventDefault()

            const form = document.forms['form']
            let book = new Book(form.elements['title'].value, form.elements['author'].value, form.elements['genre'].value, false, null)
            bookList.add(book)
            addBook(form)

            const books = document.querySelectorAll('.bookList__book')
            const dateBooks = document.querySelectorAll('.book--date')

            books.forEach((nodeBook, bookIndex) => {
                nodeBook.addEventListener("click", () => {
                    dateBooks.forEach((node, index) => {
                        if (bookIndex == index) {
                            let notDate = Date.now()
                            let date = new Date(notDate).toLocaleString()
                            node.textContent = date
                            book.read = true
                            book.readDate = date
                        }
                    })
                })
            })
        })

        const addBook = (form) => {
            const formTitle = form.elements['title']
            const formAuthor = form.elements['author']
            const formGenre = form.elements['genre']

            const bookList = document.querySelector('.bookList')
            const book = document.createElement('div')
            const bookMainInfo = document.createElement('div')
            const bookDate = document.createElement('div')
            const title = document.createElement('h3')
            const author = document.createElement('p')
            const date = document.createElement('p')

            book.classList.add('bookList__book')
            bookMainInfo.classList.add('book--title')
            bookDate.classList.add('book--date')

            const nodeTextTitle = document.createTextNode(formTitle.value)
            const nodeTextAuthor = document.createTextNode(formAuthor.value)
            const nodeTextDate = document.createTextNode('Not read')

            title.appendChild(nodeTextTitle)
            author.appendChild(nodeTextAuthor)
            date.appendChild(nodeTextDate)

            bookMainInfo.appendChild(title)
            bookMainInfo.appendChild(author)
            bookDate.appendChild(date)

            book.appendChild(bookMainInfo)
            book.appendChild(bookDate)

            bookList.appendChild(book)
        }
    </script>
</body>

</html>